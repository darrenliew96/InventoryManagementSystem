{% extends "layout.html" %}

{% block title %}
    Stocks
{% endblock %}

{% block main %}
<ul class="nav nav-tabs" id="myTab" role="tablist">
    <li class="nav-item" role="presentation">
      <button class="nav-link active" id="overview-tab" data-bs-toggle="tab" data-bs-target="#overview-tab-pane" type="button" role="tab" aria-controls="home-tab-pane" aria-selected="true">Overview</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="add-tab" data-bs-toggle="tab" data-bs-target="#addstocks-tab-pane" type="button" role="tab" aria-controls="addstocks-tab-pane" aria-selected="false">Add</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="remove-tab" data-bs-toggle="tab" data-bs-target="#deletestocks-tab-pane" type="button" role="tab" aria-controls="deletestocks-tab-pane" aria-selected="false">Remove</button>
    </li>
  </ul>

  <div class="tab-content" id="myTabContent">
    <div class="tab-pane fade show active" id="overview-tab-pane" role="tabpanel" aria-labelledby="overview-tab" tabindex="0">
        <div class="container-fluid stock-overview">

          <!--Add and Remove Stock Button Trigger Modal-->
          <div>
            <button type="button" class="btn btn-primary btn-lg" data-bs-toggle="modal" data-bs-target="#addStocksModal">
              <span class="me-2">
                <i class="bi bi-plus-circle"></i>
            </span>Add Stocks
            </button>
            

            <!--Modal for Add and Remove Stocks-->
            <div class="modal fade" id="addStocksModal" tabindex="-1" aria-labelledby="addStocksModalLabel" aria-hidden="true">
              <div class="modal-dialog modal-lg">
                <div class="modal-content">
                  <div class="modal-header">
                    <h1 class="modal-title fs-5" id="addStocksModalLabel">Add Stocks</h1>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                  </div>
                  <div class="modal-body">
                    <form method="POST" action="/form_request_addstock">
                      {{ addStocksForm.csrf_token }}
                      <div class="container">
                        <div class="row">
                          <div class="col-4">
                            {{addStocksForm.name.label}}
                            {{addStocksForm.name(class="form-control ")}}
                          </div> 
                          <div class="col-3">
                            {{ addStocksForm.brand.label }}
                            {{ addStocksForm.brand(class="form-control")}}
                          </div>
                          <div class="col-2">
                            {{ addStocksForm.quantity.label }}
                            {{ addStocksForm.quantity(class="form-control") }}
                          </div>
                          <div class="col-3">
                            {{ addStocksForm.regular_price.label }}
                            {{ addStocksForm.regular_price(class="form-control") }}
                          </div>
                          
                        </div>
                        <div class="row">
                          <div class="col">
                            {{ addStocksForm.description.label }}
                            {{ addStocksForm.description(class="form-control ") }}
                          </div>
                        </div class="row">
                          <div class="col add-stock-btn">
                            <button type=submit class="btn btn-primary">Add Stocks</button>
                          </div>
                      </div>
            
                    </form>
                  </div>
                </div>
              </div>

            </div>
            
          </div>

          <hr>
            <table id="myTable" class="display">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Brand</th>
                        <th>Quantity</th>
                        <th>Price</th>
                        <th>Action</th>
                    </tr>
                </thead>
                
                <tbody>
                  {% for stock in stocks if not stock.is_deleted %}
                    <tr>
                        <td>{{stock.name}}</td>
                        <td>{{stock.brand}}</td>
                        <td>{{stock.quantity}}</td>
                        <td>{{stock.regular_price}}</td>
                        <td>
                          <button type="button" class="btn btn-danger btn-lg" data-bs-toggle="modal" data-bs-target="#removeStocksModal">
                            <span>
                              <i class="bi bi-x-circle"></i>
                            </span>
                          </button>

                          <div class="modal fade" id="removeStocksModal" tabindex="-1" aria-labelledby="removeStocksModalLabel" aria-hidden="true">
                            <div class="modal-dialog modal-sm">
                              <div class="modal-content">
                                <div class="modal-header">
                                  <h1 class="modal-title fs-5" id="removeStocksModalLabel">Remove Stocks</h1>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                  <div class="container">
                                    <div class="row">
                                      <h6>Delete Item?</h6>
                                    </div>
                                    <div>
                                      <form action="/form_request_removestock" method="POST">
                                        <input type="hidden" id="removestockid" name="removestockid" value="{{stock.id}}">
                                        <button class="btn btn-success" type="submit">
                                          <i class="bi bi-check-circle"></i>
                                        </button>
                                      </form>
                                    </div>
                                  </div>
                                </div>
                              </div>        
                                
                            </div>
                          </div>
                        </td>
                    </tr>
                  {% endfor %}
                </tbody>
            </table>

            
        </div>
    </div>
    <div class="tab-pane fade" id="addstocks-tab-pane" role="tabpanel" aria-labelledby="add-tab" tabindex="0">
      <div>
        
      </div>
    </div>

    <div class="tab-pane fade" id="removestocks-tab-pane" role="tabpanel" aria-labelledby="remove-tab" tabindex="0">

    </div>

  </div>

  <script>
    $(document).ready(function () {
    var table = $('#myTable').DataTable({
      autoWidth: false,
      responsive: true,
      columnDefs: [
        { targets: [0, 1], width: '20%' }, // Set fixed width for columns 0 and 1
        { targets: [2, 3], width: '5%' },
        { targets: [4], width: '5%' }
    ],
    });

    } );
  </script>

{% endblock %}